<div class="max-w-6xl mx-auto px-4 py-8">
  <!-- Header -->
  <div class="text-center mb-12">
    <div class="inline-flex items-center gap-3 mb-4">
      <span class="text-5xl">ğŸ’š</span>
      <h1 class="text-4xl font-black text-white">ê¸°ë¶€ í˜„í™©</h1>
    </div>
    <p class="text-xl text-gray-400 max-w-2xl mx-auto">
      ëª¨ê¸°ì¡ì´ ì»¤ë®¤ë‹ˆí‹° ìˆ˜ìµì˜ <span class="text-green-400 font-bold">50%</span>ëŠ”<br>
      ë§ë¼ë¦¬ì•„ í‡´ì¹˜ ë‹¨ì²´ì— ê¸°ë¶€ë©ë‹ˆë‹¤
    </p>
  </div>

  <!-- Stats Cards -->
  <div class="grid md:grid-cols-3 gap-6 mb-12">
    <!-- Total Donated -->
    <div class="glass-card rounded-3xl p-8 text-center">
      <div class="w-16 h-16 mx-auto mb-4 rounded-2xl bg-gradient-to-br from-green-500 to-emerald-600 flex items-center justify-center">
        <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
        </svg>
      </div>
      <p class="text-gray-400 mb-2">ì´ ê¸°ë¶€ ê¸ˆì•¡</p>
      <p class="text-4xl font-black text-gradient">$<%= number_with_delimiter(@total_donated.to_i) %></p>
    </div>

    <!-- This Year -->
    <div class="glass-card rounded-3xl p-8 text-center">
      <div class="w-16 h-16 mx-auto mb-4 rounded-2xl bg-gradient-to-br from-blue-500 to-indigo-600 flex items-center justify-center">
        <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/>
        </svg>
      </div>
      <p class="text-gray-400 mb-2"><%= Time.current.year %>ë…„ ê¸°ë¶€</p>
      <p class="text-4xl font-black text-white">$<%= number_with_delimiter(@total_this_year.to_i) %></p>
    </div>

    <!-- Donation Count -->
    <div class="glass-card rounded-3xl p-8 text-center">
      <div class="w-16 h-16 mx-auto mb-4 rounded-2xl bg-gradient-to-br from-purple-500 to-pink-600 flex items-center justify-center">
        <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"/>
        </svg>
      </div>
      <p class="text-gray-400 mb-2">ì´ ê¸°ë¶€ íšŸìˆ˜</p>
      <p class="text-4xl font-black text-white"><%= @donation_count %>íšŒ</p>
    </div>
  </div>

  <div class="grid lg:grid-cols-2 gap-8">
    <!-- Monthly Chart -->
    <div class="glass-card rounded-3xl p-8">
      <h2 class="text-xl font-bold text-white mb-6 flex items-center gap-2">
        <svg class="w-5 h-5 text-green-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"/>
        </svg>
        ì›”ë³„ ê¸°ë¶€ í˜„í™©
      </h2>
      <div class="relative h-64">
        <canvas id="monthlyChart"></canvas>
      </div>
    </div>

    <!-- By Organization -->
    <div class="glass-card rounded-3xl p-8">
      <h2 class="text-xl font-bold text-white mb-6 flex items-center gap-2">
        <svg class="w-5 h-5 text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"/>
        </svg>
        ë‹¨ì²´ë³„ ê¸°ë¶€ í˜„í™©
      </h2>
      <div class="space-y-4">
        <% @by_organization.each do |org, amount| %>
          <div class="flex items-center justify-between p-4 rounded-xl bg-gray-800/50">
            <div class="flex items-center gap-3">
              <div class="w-10 h-10 rounded-full bg-green-500/20 flex items-center justify-center">
                <span class="text-lg">ğŸ¥</span>
              </div>
              <span class="font-medium text-white"><%= org %></span>
            </div>
            <span class="text-green-400 font-bold">$<%= number_with_delimiter(amount.to_i) %></span>
          </div>
        <% end %>
        <% if @by_organization.empty? %>
          <p class="text-center text-gray-500 py-8">ì•„ì§ ê¸°ë¶€ ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤</p>
        <% end %>
      </div>
    </div>
  </div>

  <!-- Recent Donations -->
  <div class="glass-card rounded-3xl p-8 mt-8">
    <h2 class="text-xl font-bold text-white mb-6 flex items-center gap-2">
      <svg class="w-5 h-5 text-yellow-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
      </svg>
      ìµœê·¼ ê¸°ë¶€ ë‚´ì—­
    </h2>
    <% if @donations.any? %>
      <div class="overflow-x-auto">
        <table class="w-full">
          <thead>
            <tr class="border-b border-gray-700">
              <th class="text-left py-3 px-4 text-gray-400 font-medium">ë‚ ì§œ</th>
              <th class="text-left py-3 px-4 text-gray-400 font-medium">ë‹¨ì²´</th>
              <th class="text-right py-3 px-4 text-gray-400 font-medium">ê¸ˆì•¡</th>
              <th class="text-left py-3 px-4 text-gray-400 font-medium">ë©”ëª¨</th>
            </tr>
          </thead>
          <tbody>
            <% @donations.each do |donation| %>
              <tr class="border-b border-gray-800 hover:bg-gray-800/50 transition-colors">
                <td class="py-4 px-4 text-white"><%= donation.donated_at.strftime("%Y-%m-%d") %></td>
                <td class="py-4 px-4 text-white"><%= donation.organization %></td>
                <td class="py-4 px-4 text-right text-green-400 font-bold">$<%= number_with_delimiter(donation.amount.to_i) %></td>
                <td class="py-4 px-4 text-gray-400"><%= truncate(donation.notes, length: 50) %></td>
              </tr>
            <% end %>
          </tbody>
        </table>
      </div>
    <% else %>
      <p class="text-center text-gray-500 py-8">ì•„ì§ ê¸°ë¶€ ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤</p>
    <% end %>
  </div>

  <!-- Mission Statement -->
  <div class="glass-card rounded-3xl p-8 mt-8 text-center">
    <h2 class="text-2xl font-bold text-white mb-4">ğŸ¦Ÿ ë§ë¼ë¦¬ì•„ í‡´ì¹˜ì— ë™ì°¸í•´ì£¼ì„¸ìš”</h2>
    <p class="text-gray-400 max-w-2xl mx-auto mb-6">
      ë§¤ë…„ ì „ ì„¸ê³„ì ìœ¼ë¡œ 60ë§Œ ëª… ì´ìƒì´ ë§ë¼ë¦¬ì•„ë¡œ ì‚¬ë§í•©ë‹ˆë‹¤.
      ëª¨ê¸°ì¡ì´ ì»¤ë®¤ë‹ˆí‹°ëŠ” ì¬ë¯¸ìˆëŠ” ì½˜í…ì¸ ë¥¼ í†µí•´ ë§ë¼ë¦¬ì•„ í‡´ì¹˜ì— ê¸°ì—¬í•©ë‹ˆë‹¤.
    </p>
    <div class="flex flex-wrap justify-center gap-4">
      <a href="https://www.againstmalaria.com" target="_blank" rel="noopener" class="px-6 py-3 bg-gradient-to-r from-green-500 to-emerald-600 text-white font-bold rounded-xl hover:shadow-lg hover:shadow-green-500/25 transition-all">
        Against Malaria Foundation
      </a>
      <a href="https://www.malariaconsortium.org" target="_blank" rel="noopener" class="px-6 py-3 bg-gray-800 text-white font-bold rounded-xl hover:bg-gray-700 transition-all">
        Malaria Consortium
      </a>
    </div>
  </div>
</div>

<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
  document.addEventListener('DOMContentLoaded', function() {
    const monthlyData = <%= raw @monthly_totals.to_json %>;
    const months = ['1ì›”', '2ì›”', '3ì›”', '4ì›”', '5ì›”', '6ì›”', '7ì›”', '8ì›”', '9ì›”', '10ì›”', '11ì›”', '12ì›”'];
    const data = months.map((_, i) => monthlyData[i + 1] || 0);

    const ctx = document.getElementById('monthlyChart').getContext('2d');
    new Chart(ctx, {
      type: 'bar',
      data: {
        labels: months,
        datasets: [{
          label: 'ê¸°ë¶€ ê¸ˆì•¡ ($)',
          data: data,
          backgroundColor: 'rgba(34, 197, 94, 0.5)',
          borderColor: 'rgba(34, 197, 94, 1)',
          borderWidth: 2,
          borderRadius: 8,
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: {
            display: false
          }
        },
        scales: {
          y: {
            beginAtZero: true,
            grid: {
              color: 'rgba(255, 255, 255, 0.1)'
            },
            ticks: {
              color: '#9CA3AF',
              callback: function(value) {
                return '$' + value.toLocaleString();
              }
            }
          },
          x: {
            grid: {
              display: false
            },
            ticks: {
              color: '#9CA3AF'
            }
          }
        }
      }
    });
  });
</script>
